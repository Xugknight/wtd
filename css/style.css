:root{
  --bg:#0a0c10; --surface:#0f141b; --muted:#1a2130; --text:#e6eef6; --sub:#9fb0c2;
  --accent:#7dd3fc; --danger:#ff6b6b; --ok:#7be495; --shadow:0 10px 30px rgba(0,0,0,.35);
  --rule:#36465f; --margin:#ff6b6b;
  --line-alpha: 0.7;
}

[data-theme="light"]{
  --bg:#fff6c7;
  --surface:#fffdf3;
  --muted:#f1e7ba;
  --text:#2a2a24;
  --sub:#5b5b49;
  --accent:#2a77ff;
  --danger:#d92d20;
  --ok:#10b981;
  --shadow:0 12px 30px rgba(0,0,0,.12);
  --rule:#6aa0ff;
  --margin:#ff6b6b;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--text);
  font:16px/1.5 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, "Apple Color Emoji","Segoe UI Emoji";
  display:grid; grid-template-rows:auto 1fr;
  background:
    linear-gradient(90deg, transparent 96px, color-mix(in srgb, var(--margin), transparent calc((1 - var(--line-alpha)) * 100%)) 96px, color-mix(in srgb, var(--margin), transparent calc((1 - var(--line-alpha)) * 100%)) 98px, transparent 98px),
    repeating-linear-gradient(0deg,
      transparent 0 26px,
      color-mix(in srgb, var(--rule), transparent calc((1 - var(--line-alpha)) * 100%)) 26px 27px,
      transparent 27px 28px),
    var(--bg);
  background-attachment: fixed;
}

.appbar{
  padding: .8rem 1rem .4rem; border-bottom:1px solid color-mix(in srgb, var(--text), transparent 90%);
  background: var(--bg);
}
.brand{margin:0 0 .6rem; font-size:1.25rem; letter-spacing:.2px}

.toolbar{
  display:flex; align-items:center; gap:.5rem; padding:.6rem .8rem; background:linear-gradient(180deg, var(--surface), color-mix(in srgb, var(--surface), transparent 15%));
  border:1px solid color-mix(in srgb, var(--text), transparent 90%); border-radius:12px; box-shadow: var(--shadow);
}
.toolbar .left, .toolbar .right{display:flex; gap:.5rem; align-items:center}
.toolbar .spacer{flex:1}

.layout{
  display:grid; grid-template-columns: 1fr 320px; gap:1rem; padding:1rem;
}
@media (max-width: 980px){
  .layout{grid-template-columns: 1fr}
  .sidebar{order:2}
}

.sidebar{
  background:var(--surface); border:1px solid color-mix(in srgb, var(--text), transparent 88%); border-radius:16px; padding:1rem; box-shadow:var(--shadow);
}
.sidebar h2{margin-top:0}

.workspace{min-width:0}

.tabs{
  display:flex; gap:.4rem; align-items:center; margin:.8rem 0;
}
.tab{
  background:var(--muted); color:var(--text); border:1px solid color-mix(in srgb, var(--text), transparent 85%); border-radius:999px;
  padding:.35rem .7rem; cursor:pointer; font-weight:600;
}
.tab.active{outline:2px solid var(--accent)}
.tab.add{font-weight:700}

.editorRow{
  display:grid; grid-template-columns: 1fr minmax(280px, 40%); gap:1rem;
}
@media (max-width: 1100px){
  .editorRow{grid-template-columns: 1fr}
  #mdPreview{min-height:180px}
}

#pad, #mdPreview{
  background:var(--surface); border:1px solid color-mix(in srgb, var(--text), transparent 88%); border-radius:16px; padding:1.2rem 1.4rem; box-shadow:var(--shadow);
}
#pad{
  min-height:50vh; outline:none; overflow:auto; white-space:pre-wrap;
}
#pad.is-mono{font:15px/1.55 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace}
#pad.nowrap{white-space:pre}
#pad:empty:before{content:attr(data-placeholder); color:var(--sub)}

#mdPreview{
  font-size:.95rem; line-height:1.6; overflow:auto; min-height:50vh;
}
#mdPreview h1{font-size:1.6rem} #mdPreview h2{font-size:1.3rem} #mdPreview h3{font-size:1.1rem}
#mdPreview code{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; padding:.15rem .3rem; border-radius:.3rem; background:var(--muted)}
#mdPreview pre{padding:.7rem; border-radius:.6rem; background:var(--muted); overflow:auto}
#mdPreview a{color:var(--accent); text-decoration:underline}

.btn{
  appearance:none; border:0; border-radius:999px; padding:.45rem .75rem; background:var(--muted); color:var(--text); cursor:pointer; font-weight:600; letter-spacing:.1px; transition:transform .06s ease, background .2s;
}
.btn:hover{transform:translateY(-1px)}
.btn:active{transform:translateY(0)}
.btn.primary{background:color-mix(in srgb, var(--accent), transparent 10%)}
.btn.ghost{background:transparent; border:1px solid color-mix(in srgb, var(--text), transparent 85%)}
.btn.danger{background:color-mix(in srgb, var(--danger), transparent 10%)}
.btn.small{padding:.35rem .6rem; font-size:.9rem}

label.switch{display:inline-flex; align-items:center; gap:.35rem; font-size:.9rem; color:var(--sub)}
label.switch input{accent-color:var(--accent)}

.kbd{font:12px/1.2 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; background:var(--muted); padding:.15rem .4rem; border-radius:.4rem; border:1px solid color-mix(in srgb, var(--text), transparent 85%)}
.hidden{display:none}
.preview.hidden{display:none}