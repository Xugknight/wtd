:root{
  --bg:#0b0e11;
  --surface:#11161c;
  --muted:#18202a;
  --text:#e7e5e4;
  --sub:#a8b0b8;
  --accent:#f59e0b;
  --danger:#ef4444;
  --ok:#10b981;
  --shadow:0 18px 50px rgba(0,0,0,.35);

  /* Notebook rules */
  --rule:#334155;
  --margin:#ef4444;
  --line-alpha: 0.7;
  --margin-x: 110px;

  --paper-surface-dark:#0f141a;
  --paper-surface-light:#fff3c8;
  --paper-border-dark: color-mix(in srgb, var(--text), transparent 85%);
  --paper-border-light:#e7d99d;
}

[data-theme="light"]{
  --bg:#fff6c7;
  --surface:#fff0b8;
  --muted:#f4e6ab;
  --text:#2a2a24;
  --sub:#5b5b49;
  --accent:#2a77ff;
  --danger:#d92d20;
  --ok:#10b981;
  --shadow:0 12px 30px rgba(0,0,0,.12);
  --rule:#6aa0ff;
  --margin:#ff6b6b;

  /* Paper surfaces for blocks */
  --paper-surface-light:#fff3c8;
  --paper-border-light:#e6d594;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--text);
  font:16px/1.5 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, "Apple Color Emoji","Segoe UI Emoji";
  display:grid; grid-template-rows:auto 1fr;

  background:
    linear-gradient(90deg,
      transparent var(--margin-x),
      color-mix(in srgb, var(--margin), transparent calc((1 - var(--line-alpha)) * 100%)) var(--margin-x),
      color-mix(in srgb, var(--margin), transparent calc((1 - var(--line-alpha)) * 100%)) calc(var(--margin-x) + 2px),
      transparent calc(var(--margin-x) + 2px)
    ),
    repeating-linear-gradient(0deg,
      transparent 0 26px,
      color-mix(in srgb, var(--rule), transparent calc((1 - var(--line-alpha)) * 100%)) 26px 27px,
      transparent 27px 28px
    ),
    var(--bg);
  background-attachment: fixed;
}

.appbar{
  padding:.8rem 1rem .4rem;
  border-bottom:1px solid color-mix(in srgb, var(--text), transparent 90%);
  background: var(--surface);
}
.brand{margin:0 0 .6rem; font-size:1.25rem; letter-spacing:.2px}

.toolbar{
  display:flex; align-items:center; gap:.5rem; padding:.6rem .8rem;
  background:linear-gradient(180deg, var(--surface), color-mix(in srgb, var(--surface), transparent 15%));
  border:1px solid color-mix(in srgb, var(--text), transparent 90%);
  border-radius:12px; box-shadow:var(--shadow);
}
.toolbar .left, .toolbar .right{display:flex; gap:.5rem; align-items:center}
.toolbar .spacer{flex:1}

.layout{
  display:grid; grid-template-columns: 1fr 320px; gap:1rem;
  padding:1rem 1rem 1rem calc(var(--margin-x) + 16px);
}
@media (max-width: 980px){
  .layout{grid-template-columns: 1fr; padding:1rem}
  .sidebar{order:2}
}

.sidebar{
  background:var(--surface); border:1px solid color-mix(in srgb, var(--text), transparent 88%); border-radius:16px; padding:1rem; box-shadow:var(--shadow);
}
.sidebar h2{margin-top:0}

.workspace{min-width:0}

.tabs{ margin:.8rem 0 .6rem; }
.tabs .tab.add {
  margin-left: .5rem;
}
.tab{
  background:var(--muted); color:var(--text); border:1px solid color-mix(in srgb, var(--text), transparent 85%); border-radius:999px;
  padding:.35rem .7rem; cursor:pointer; font-weight:600;
}
.tab.active{outline:2px solid var(--accent)}
.tab.add{font-weight:700}

.editorRow{
  margin-top: .2rem;
  display:grid; grid-template-columns: 1fr minmax(280px, 40%); gap:1rem;
}
@media (max-width: 1100px){
  .editorRow{grid-template-columns: 1fr}
}

#pad, #mdPreview, .sidebar{
  background: color-mix(in srgb, var(--paper-surface-dark), transparent 0%);
  border:1px solid var(--paper-border-dark);
}
[data-theme="light"] #pad,
[data-theme="light"] #mdPreview,
[data-theme="light"] .sidebar{
  background: var(--paper-surface-light);
  border:1px solid var(--paper-border-light);
}
#pad{
  max-width: min(900px, 100%);
  min-height:50vh; outline:none; overflow:auto; white-space:pre-wrap;
  border-radius:16px; padding:1.2rem 1.4rem; box-shadow:var(--shadow);
}
#pad.is-mono{font:15px/1.55 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace}
#pad.nowrap{white-space:pre}
#pad:empty:before{content:attr(data-placeholder); color:var(--sub)}

#mdPreview{
  border-radius:16px;
  box-shadow:var(--shadow);
  border:1px solid var(--paper-border-dark);
  background: color-mix(in srgb, var(--paper-surface-dark), transparent 0%);
}
[data-theme="light"] #mdPreview{
  border:1px solid var(--paper-border-light);
  background: var(--paper-surface-light);
}
#mdPreview{
  font-size:.95rem; line-height:1.6; overflow:auto; min-height:50vh;
}
#mdPreview h1{font-size:1.6rem} #mdPreview h2{font-size:1.3rem} #mdPreview h3{font-size:1.1rem}
#mdPreview code{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; padding:.15rem .3rem; border-radius:.3rem; background:var(--muted)}
#mdPreview pre{padding:.7rem; border-radius:.6rem; background:var(--muted); overflow:auto}
#mdPreview a{color:var(--accent); text-decoration:underline}

.btn{
  appearance:none; border:0; border-radius:999px; padding:.45rem .75rem; background:var(--muted); color:var(--text); cursor:pointer; font-weight:600; letter-spacing:.1px; transition:transform .06s ease, background .2s;
}
.btn:hover{transform:translateY(-1px)}
.btn:active{transform:translateY(0)}
.btn.primary{background:color-mix(in srgb, var(--accent), transparent 10%)}
.btn.ghost{background:transparent; border:1px solid color-mix(in srgb, var(--text), transparent 85%)}
.btn.danger{background:color-mix(in srgb, var(--danger), transparent 10%)}
.btn.small{padding:.35rem .6rem; font-size:.9rem}

label.switch{display:inline-flex; align-items:center; gap:.35rem; font-size:.9rem; color:var(--sub)}
label.switch input{accent-color:var(--accent)}

.kbd{font:12px/1.2 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; background:var(--muted); padding:.15rem .4rem; border-radius:.4rem; border:1px solid color-mix(in srgb, var(--text), transparent 85%)}
.hidden{display:none}
.preview.hidden{display:none}